# **************************************************************************** #
#                                                                              #
#                                                         :::      ::::::::    #
#    action.yml                                         :+:      :+:    :+:    #
#                                                     +:+ +:+         +:+      #
#    By: agaley <agaley@student.42lyon.fr>          +#+  +:+       +#+         #
#                                                 +#+#+#+#+#+   +#+            #
#    Created: 2022/11/08 01:07:00 by agaley            #+#    #+#              #
#    Updated: 2022/11/09 17:00:02 by agaley           ###   ########lyon.fr    #
#                                                                              #
# **************************************************************************** #

name: 'libftOps'
author: 'unkn0wn107'
description: 'CI pour ta libft'

runs:
    using: composite
    steps:
      - uses: actions/checkout@v3
        with:
          path: libft
          
      - name: Install apt deps
        uses: awalsh128/cache-apt-pkgs-action@latest
        with:
          packages: gcc clang libpq-dev libbsd-dev libncurses-dev valgrind python3-dev python3-venv python3-wheel python3-testresources
          
      - run: curl -fsSL https://raw.githubusercontent.com/unkn0wn107/francinette/ghaction-ready/requirements.txt > requirements.txt
        shell: bash

      - uses: actions/setup-python@v4
        with:
          python-version: '3.9'
          cache: 'pip'

      - name: Install Francinette
        shell: bash
        run: |
          curl -fsSL https://raw.githubusercontent.com/unkn0wn107/francinette/ghaction-ready/bin/gh-install.sh > install.sh
          chmod +x install.sh
          ./install.sh

      - name: Run tests
        shell: bash
        run: cd libft && bash ~/francinette/tester.sh
